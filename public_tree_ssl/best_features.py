# lgb_params = {
#     'objective':        'binary',
#     'verbosity':        -1,
#     'num_iterations':   200,
#     'boosting_type':    'gbdt',
#     'random_state':     seed,
#     'lambda_l1':        0.08758718919397321,
#     'lambda_l2':        0.0039689175176025465,
#     'learning_rate':    0.03231007103195577,
#     'max_depth':        4,
#     'num_leaves':       103,
#     'colsample_bytree': 0.8329551585827726,
#     'colsample_bynode': 0.4025961355653304,
#     'bagging_fraction': 0.7738954452473223,
#     'bagging_freq':     4,
#     'min_data_in_leaf': 85,
#     'scale_pos_weight': 2.7984184778875543,
# }
#
#
# lgb_model = Pipeline([
#    ('sampler_1', RandomOverSampler(sampling_strategy=0.003, random_state=seed)),
#     ('sampler_2', RandomUnderSampler(sampling_strategy=sampling_ratio , random_state=seed)),
#     ('classifier', lgb.LGBMClassifier(**lgb_params)),
# ])

lgb_feats = ['clin_size_long_diam_mm', 'tbp_lv_C', 'tbp_lv_deltaLBnorm', 'color_contrast_index', 'age_normalized_nevi_confidence', 'age_normalized_nevi_confidence_2', 'tbp_lv_B_patient_norm', 'tbp_lv_H_patient_norm', 'tbp_lv_radial_color_std_max_patient_norm', 'tbp_lv_y_patient_norm', 'color_uniformity_patient_norm', 'position_distance_3d_patient_norm', 'lesion_orientation_3d_patient_norm', 'age_normalized_nevi_confidence_2_patient_norm', 'color_asymmetry_index_patient_norm', 'count_per_patient', 'age_approx_patient_min_max', 'tbp_lv_B_patient_min_max', 'tbp_lv_H_patient_min_max', 'tbp_lv_Hext_patient_min_max', 'tbp_lv_minorAxisMM_patient_min_max', 'tbp_lv_y_patient_min_max', 'lesion_size_ratio_patient_min_max', 'position_distance_3d_patient_min_max', 'area_to_perimeter_ratio_patient_min_max', 'lesion_orientation_3d_patient_min_max', 'pred_5_patient_min_max_norm', 'pred_18_patient_min_max_norm', 'pred_22_patient_min_max_norm', 'pred_44_patient_min_max_norm', 'b_pred_26_patient_norm', 'b_pred_59_patient_norm', 'b_pred_29_patient_min_max_norm', 'b_pred_57_patient_min_max_norm', 'image_pred_18_patient_norm', 'image_pred_37_patient_norm', 'image_pred_39_patient_norm', 'image_pred_42_patient_norm', 'image_pred_45_patient_norm', 'image_pred_56_patient_norm', 'image_pred_16_patient_min_max_norm', 'image_pred_17_patient_min_max_norm', 'image_pred_21_patient_min_max_norm', 'pred_12', 'pred_27', 'pred_39', 'age_approx_future_norm', 'tbp_lv_H_future_norm', 'tbp_lv_L_future_norm', 'lesion_visibility_score_future_norm', 'lesion_orientation_3d_future_norm', 'overall_color_difference_future_norm', 'age_normalized_nevi_confidence_2_future_norm', 'image_pred_16_future_norm', 'tbp_lv_Hext_past_norm', 'tbp_lv_area_perim_ratio_past_norm', 'tbp_lv_x_past_norm', 'hue_contrast_past_norm', 'lesion_severity_index_past_norm', 'pred_1_past_norm', 'pred_37_past_norm', 'b_pred_6_past_norm', 'b_pred_46_past_norm', 'b_pred_49_past_norm', 'b_pred_52_past_norm', 'b_pred_58_past_norm', 'image_pred_2_past_norm', 'image_pred_42_past_norm', 'image_pred_56_past_norm', 'count_past', 'tbp_lv_deltaA_attri_norm', 'tbp_lv_norm_border_attri_norm', 'hue_contrast_attri_norm', 'color_uniformity_attri_norm', 'pred_24_attri_norm', 'b_pred_16_attri_norm', 'b_pred_26_attri_norm', 'b_pred_27_attri_norm', 'b_pred_36_attri_norm', 'clin_size_long_diam_mm_tile_type_norm', 'tbp_lv_Lext_tile_type_norm', 'position_distance_3d_tile_type_norm', 'age_normalized_nevi_confidence_2_tile_type_norm', 'count_per_patient_tile_type_norm', 'pred_6_tile_type_norm', 'pred_27_tile_type_norm', 'pred_39_tile_type_norm', 'b_pred_28_tile_type_norm', 'b_pred_47_tile_type_norm', 'image_pred_48_tile_type_norm', 'image_pred_59_tile_type_norm', 'tbp_lv_y_anatom_norm', 'pred_24_anatom_norm', 'b_pred_12_anatom_norm', 'b_pred_21_anatom_norm', 'image_pred_26_anatom_norm', 'image_pred_49_anatom_norm', 'tbp_lv_Hext_multi_min_max', 'tbp_lv_stdLExt_multi_min_max', 'size_age_interaction_multi_min_max', 'std_dev_contrast_multi_min_max', 'age_normalized_nevi_confidence_2_multi_min_max', 'count_per_patient_multi_min_max', 'pred_9_multi_min_max', 'pred_16_multi_min_max', 'pred_31_multi_min_max', 'pred_39_multi_min_max', 'b_pred_10_multi_min_max', 'b_pred_14_multi_min_max', 'b_pred_20_multi_min_max', 'image_pred_0_multi_min_max', 'image_pred_12_multi_min_max']
#112, 1.819


# Best overall
# iteration: 80
# best iter: 35 best score: 0.17990389153233854
# best lgb: 53 best score: 0.18191421143081163
# best xgb: 35 best score: 0.17797866341948804
# best cat: 72 best score: 0.17197159977536147
#
# lgb_feats =  ['clin_size_long_diam_mm', 'tbp_lv_C', 'tbp_lv_deltaLBnorm', 'color_contrast_index', 'age_normalized_nevi_confidence_2', 'tbp_lv_B_patient_norm', 'tbp_lv_H_patient_norm', 'tbp_lv_radial_color_std_max_patient_norm', 'tbp_lv_y_patient_norm', 'color_uniformity_patient_norm', 'position_distance_3d_patient_norm', 'lesion_orientation_3d_patient_norm', 'age_normalized_nevi_confidence_2_patient_norm', 'age_approx_patient_min_max', 'tbp_lv_Hext_patient_min_max', 'tbp_lv_minorAxisMM_patient_min_max', 'position_distance_3d_patient_min_max', 'area_to_perimeter_ratio_patient_min_max', 'lesion_orientation_3d_patient_min_max', 'pred_5_patient_min_max_norm', 'pred_18_patient_min_max_norm', 'pred_22_patient_min_max_norm', 'b_pred_26_patient_norm', 'b_pred_57_patient_min_max_norm', 'image_pred_18_patient_norm', 'image_pred_37_patient_norm', 'image_pred_42_patient_norm', 'image_pred_45_patient_norm', 'image_pred_56_patient_norm', 'image_pred_16_patient_min_max_norm', 'image_pred_17_patient_min_max_norm', 'pred_12', 'pred_39', 'age_approx_future_norm', 'tbp_lv_H_future_norm', 'tbp_lv_L_future_norm', 'lesion_visibility_score_future_norm', 'age_normalized_nevi_confidence_2_future_norm', 'image_pred_16_future_norm', 'tbp_lv_area_perim_ratio_past_norm', 'tbp_lv_x_past_norm', 'hue_contrast_past_norm', 'lesion_severity_index_past_norm', 'pred_1_past_norm', 'b_pred_6_past_norm', 'b_pred_46_past_norm', 'b_pred_52_past_norm', 'image_pred_42_past_norm', 'image_pred_56_past_norm', 'count_past', 'tbp_lv_deltaA_attri_norm', 'hue_contrast_attri_norm', 'color_uniformity_attri_norm', 'b_pred_16_attri_norm', 'b_pred_26_attri_norm', 'b_pred_36_attri_norm', 'clin_size_long_diam_mm_tile_type_norm', 'tbp_lv_Lext_tile_type_norm', 'position_distance_3d_tile_type_norm', 'age_normalized_nevi_confidence_2_tile_type_norm', 'count_per_patient_tile_type_norm', 'pred_6_tile_type_norm', 'pred_27_tile_type_norm', 'b_pred_47_tile_type_norm', 'image_pred_48_tile_type_norm', 'image_pred_59_tile_type_norm', 'tbp_lv_y_anatom_norm', 'pred_24_anatom_norm', 'b_pred_12_anatom_norm', 'b_pred_21_anatom_norm', 'image_pred_26_anatom_norm', 'image_pred_49_anatom_norm', 'tbp_lv_Hext_multi_min_max', 'tbp_lv_stdLExt_multi_min_max', 'std_dev_contrast_multi_min_max', 'count_per_patient_multi_min_max', 'pred_9_multi_min_max', 'pred_16_multi_min_max', 'pred_31_multi_min_max', 'pred_39_multi_min_max', 'b_pred_10_multi_min_max', 'b_pred_14_multi_min_max', 'b_pred_20_multi_min_max', 'image_pred_0_multi_min_max', 'image_pred_12_multi_min_max']
# cat_feats =  ['clin_size_long_diam_mm', 'tbp_lv_Hext', 'tbp_lv_deltaLBnorm', 'tbp_lv_y', 'mean_hue_difference', 'color_range', 'age_size_symmetry_index', 'tbp_lv_C_patient_norm', 'tbp_lv_H_patient_norm', 'color_uniformity_patient_norm', 'lesion_visibility_score_patient_norm', 'mean_hue_difference_patient_norm', 'lesion_orientation_3d_patient_norm', 'overall_color_difference_patient_norm', 'age_normalized_nevi_confidence_2_patient_norm', 'tbp_lv_C_patient_min_max', 'tbp_lv_H_patient_min_max', 'tbp_lv_y_patient_min_max', 'position_distance_3d_patient_min_max', 'perimeter_to_area_ratio_patient_min_max', 'area_to_perimeter_ratio_patient_min_max', 'symmetry_border_consistency_patient_min_max', 'color_variance_ratio_patient_min_max', 'color_asymmetry_index_patient_min_max', 'pred_12_patient_min_max_norm', 'pred_22_patient_min_max_norm', 'pred_32_patient_min_max_norm', 'b_pred_2_patient_norm', 'b_pred_12_patient_norm', 'b_pred_13_patient_norm', 'b_pred_15_patient_norm', 'b_pred_16_patient_norm', 'b_pred_26_patient_norm', 'b_pred_40_patient_norm', 'b_pred_46_patient_norm', 'b_pred_56_patient_norm', 'b_pred_59_patient_norm', 'b_pred_42_patient_min_max_norm', 'image_pred_2_patient_norm', 'image_pred_37_patient_norm', 'image_pred_42_patient_norm', 'image_pred_56_patient_norm', 'image_pred_59_patient_norm', 'image_pred_8_patient_min_max_norm', 'image_pred_56_patient_min_max_norm', 'age_approx_future_norm', 'color_uniformity_future_norm', 'color_shape_composite_index_future_norm', 'pred_22_future_norm', 'b_pred_26_future_norm', 'image_pred_42_future_norm', 'image_pred_56_future_norm', 'border_length_ratio_past_norm', 'pred_27_past_norm', 'count_past', 'tbp_lv_deltaLBnorm_attri_norm', 'tbp_lv_symm_2axis_angle_attri_norm', 'volume_approximation_3d_attri_norm', 'pred_6_attri_norm', 'b_pred_26_attri_norm', 'image_pred_15_attri_norm', 'clin_size_long_diam_mm_tile_type_norm', 'normalized_lesion_size_tile_type_norm', 'image_pred_46_tile_type_norm', 'image_pred_59_tile_type_norm', 'lesion_color_difference_anatom_norm', 'color_consistency_anatom_norm', 'pred_27_anatom_norm', 'b_pred_46_anatom_norm', 'image_pred_3_anatom_norm', 'image_pred_8_anatom_norm', 'tbp_lv_radial_color_std_max_multi_min_max', 'tbp_lv_stdLExt_multi_min_max', 'log_lesion_area_multi_min_max', 'age_normalized_nevi_confidence_2_multi_min_max', 'color_asymmetry_index_multi_min_max', 'count_per_patient_multi_min_max', 'pred_2_multi_min_max', 'pred_9_multi_min_max', 'pred_39_multi_min_max', 'pred_42_multi_min_max', 'b_pred_4_multi_min_max', 'b_pred_29_multi_min_max', 'image_pred_23_multi_min_max', 'image_pred_52_multi_min_max']
# xgb_feats =  ['clin_size_long_diam_mm', 'tbp_lv_deltaA', 'tbp_lv_deltaLBnorm', 'color_uniformity', 'position_distance_3d', 'mean_hue_difference', 'age_normalized_nevi_confidence', 'age_normalized_nevi_confidence_2', 'tbp_lv_B_patient_norm', 'tbp_lv_H_patient_norm', 'tbp_lv_minorAxisMM_patient_norm', 'tbp_lv_norm_color_patient_norm', 'tbp_lv_y_patient_norm', 'position_distance_3d_patient_norm', 'overall_color_difference_patient_norm', 'age_normalized_nevi_confidence_2_patient_norm', 'color_asymmetry_index_patient_norm', 'color_range_patient_norm', 'age_approx_patient_min_max', 'tbp_lv_B_patient_min_max', 'tbp_lv_H_patient_min_max', 'tbp_lv_Hext_patient_min_max', 'position_distance_3d_patient_min_max', 'area_to_perimeter_ratio_patient_min_max', 'b_pred_16_patient_norm', 'b_pred_26_patient_norm', 'b_pred_59_patient_norm', 'b_pred_26_patient_min_max_norm', 'b_pred_57_patient_min_max_norm', 'image_pred_8_patient_norm', 'image_pred_41_patient_norm', 'image_pred_5_patient_min_max_norm', 'image_pred_37_patient_min_max_norm', 'onehot_45', 'pred_27', 'age_approx_future_norm', 'tbp_lv_H_future_norm', 'lesion_visibility_score_future_norm', 'overall_color_difference_future_norm', 'age_normalized_nevi_confidence_2_future_norm', 'b_pred_26_future_norm', 'image_pred_5_future_norm', 'image_pred_56_future_norm', 'hue_contrast_past_norm', 'lesion_orientation_3d_past_norm', 'pred_27_past_norm', 'b_pred_34_past_norm', 'b_pred_49_past_norm', 'image_pred_22_past_norm', 'image_pred_39_past_norm', 'count_past', 'clin_size_long_diam_mm_attri_norm', 'tbp_lv_deltaLBnorm_attri_norm', 'color_uniformity_attri_norm', 'normalized_lesion_size_attri_norm', 'pred_31_attri_norm', 'b_pred_6_attri_norm', 'b_pred_26_attri_norm', 'image_pred_46_attri_norm', 'clin_size_long_diam_mm_tile_type_norm', 'tbp_lv_deltaLBnorm_tile_type_norm', 'age_normalized_nevi_confidence_2_tile_type_norm', 'count_per_patient_tile_type_norm', 'pred_6_tile_type_norm', 'pred_27_tile_type_norm', 'b_pred_26_tile_type_norm', 'b_pred_28_tile_type_norm', 'image_pred_39_tile_type_norm', 'image_pred_41_tile_type_norm', 'image_pred_46_tile_type_norm', 'image_pred_48_tile_type_norm', 'image_pred_59_tile_type_norm', 'tbp_lv_H_anatom_norm', 'tbp_lv_deltaLBnorm_anatom_norm', 'lesion_color_difference_anatom_norm', 'color_uniformity_anatom_norm', 'image_pred_8_anatom_norm', 'image_pred_48_anatom_norm', 'tbp_lv_radial_color_std_max_multi_min_max', 'count_per_patient_multi_min_max', 'pred_31_multi_min_max', 'pred_39_multi_min_max', 'b_pred_20_multi_min_max', 'b_pred_28_multi_min_max', 'b_pred_36_multi_min_max']
# lgb feats: 85 cat feats: 85 xgb feats: 85
#
# Fold 1 - Validation Score: 0.1845195238553598 lgb: 0.18621827574036637 xgb: 0.17936920460743733 cat: 0.1769007283344563
# Fold 2 - Validation Score: 0.17655109102950103 lgb: 0.1741225374343827 xgb: 0.1737160593872123 cat: 0.17262116849016235
# Fold 3 - Validation Score: 0.1807840940735534 lgb: 0.18310365179284616 xgb: 0.17724414274180467 cat: 0.17195782145217062
# Fold 4 - Validation Score: 0.17925265920707273 lgb: 0.1836238891191232 xgb: 0.17760821015794076 cat: 0.16415527006492606
# Fold 5 - Validation Score: 0.17973528382241402 lgb: 0.1795180172296443 xgb: 0.17773702915038014 cat: 0.1640660793808218
# Average Validation Score: 0.18016853039758018 average lgb: 0.18131727426327254 average xgb: 0.17713492920895507 average cat: 0.16994021354450745

# ==========================================================

lgb_feats =  ['clin_size_long_diam_mm', 'tbp_lv_deltaLBnorm', 'color_uniformity', 'color_contrast_index', 'age_normalized_nevi_confidence', 'age_normalized_nevi_confidence_2', 'age_approx_patient_norm', 'clin_size_long_diam_mm_patient_norm', 'tbp_lv_H_patient_norm', 'tbp_lv_Hext_patient_norm', 'tbp_lv_eccentricity_patient_norm', 'tbp_lv_radial_color_std_max_patient_norm', 'tbp_lv_y_patient_norm', 'color_uniformity_patient_norm', 'position_distance_3d_patient_norm', 'lesion_visibility_score_patient_norm', 'lesion_severity_index_patient_norm', 'lesion_orientation_3d_patient_norm', 'overall_color_difference_patient_norm', 'age_normalized_nevi_confidence_2_patient_norm', 'tbp_lv_H_patient_min_max', 'tbp_lv_Hext_patient_min_max', 'tbp_lv_L_patient_min_max', 'tbp_lv_Lext_patient_min_max', 'tbp_lv_minorAxisMM_patient_min_max', 'tbp_lv_y_patient_min_max', 'lesion_size_ratio_patient_min_max', 'position_distance_3d_patient_min_max', 'lesion_orientation_3d_patient_min_max', 'age_normalized_nevi_confidence_2_patient_min_max', 'pred_5_patient_min_max_norm', 'pred_18_patient_min_max_norm', 'pred_22_patient_min_max_norm', 'b_pred_2_patient_norm', 'b_pred_18_patient_norm', 'b_pred_26_patient_norm', 'b_pred_59_patient_norm', 'b_pred_16_patient_min_max_norm', 'b_pred_57_patient_min_max_norm', 'image_pred_16_patient_norm', 'image_pred_17_patient_norm', 'image_pred_45_patient_norm', 'image_pred_56_patient_norm', 'image_pred_57_patient_norm', 'image_pred_5_patient_min_max_norm', 'image_pred_16_patient_min_max_norm', 'image_pred_17_patient_min_max_norm', 'image_pred_18_patient_min_max_norm', 'image_pred_21_patient_min_max_norm', 'image_pred_22_patient_min_max_norm', 'image_pred_23_patient_min_max_norm', 'image_pred_56_patient_min_max_norm', 'pred_2', 'pred_12', 'age_approx_future_norm', 'tbp_lv_H_future_norm', 'tbp_lv_L_future_norm', 'position_distance_3d_future_norm', 'lesion_severity_index_future_norm', 'age_normalized_nevi_confidence_2_future_norm', 'b_pred_28_future_norm', 'image_pred_56_future_norm', 'hue_contrast_past_norm', 'lesion_orientation_3d_past_norm', 'pred_1_past_norm', 'b_pred_6_past_norm', 'b_pred_11_past_norm', 'b_pred_46_past_norm', 'b_pred_51_past_norm', 'b_pred_52_past_norm', 'b_pred_56_past_norm', 'b_pred_58_past_norm', 'image_pred_2_past_norm', 'image_pred_18_past_norm', 'image_pred_20_past_norm', 'image_pred_39_past_norm', 'count_past', 'hue_contrast_attri_norm', 'border_complexity_attri_norm', 'color_uniformity_attri_norm', 'pred_0_attri_norm', 'pred_19_attri_norm', 'b_pred_16_attri_norm', 'b_pred_26_attri_norm', 'b_pred_36_attri_norm', 'image_pred_48_attri_norm', 'clin_size_long_diam_mm_tile_type_norm', 'tbp_lv_B_tile_type_norm', 'position_distance_3d_tile_type_norm', 'age_normalized_nevi_confidence_2_tile_type_norm', 'count_per_patient_tile_type_norm', 'pred_6_tile_type_norm', 'pred_27_tile_type_norm', 'pred_39_tile_type_norm', 'b_pred_47_tile_type_norm', 'b_pred_51_tile_type_norm', 'image_pred_59_tile_type_norm', 'tbp_lv_deltaLBnorm_anatom_norm', 'tbp_lv_y_anatom_norm', 'color_range_anatom_norm', 'pred_24_anatom_norm', 'pred_39_anatom_norm', 'b_pred_12_anatom_norm', 'b_pred_21_anatom_norm', 'b_pred_33_anatom_norm', 'image_pred_26_anatom_norm', 'image_pred_49_anatom_norm', 'tbp_lv_Hext_multi_min_max', 'tbp_lv_stdLExt_multi_min_max', 'symmetry_border_consistency_multi_min_max', 'size_age_interaction_multi_min_max', 'normalized_lesion_size_multi_min_max', 'age_normalized_nevi_confidence_2_multi_min_max', 'count_per_patient_multi_min_max', 'pred_2_multi_min_max', 'pred_9_multi_min_max', 'pred_16_multi_min_max', 'pred_31_multi_min_max', 'pred_39_multi_min_max', 'pred_40_multi_min_max', 'b_pred_10_multi_min_max', 'b_pred_20_multi_min_max', 'b_pred_56_multi_min_max', 'image_pred_0_multi_min_max', 'image_pred_33_multi_min_max', 'image_pred_57_multi_min_max']
# 126 0.183

# lgb_params = {
#     'objective':        'binary',
#     'verbosity':        -1,
#     'num_iterations':   200,
#     'boosting_type':    'gbdt',
#     'random_state':     seed,
#     'lambda_l1':        0.08758718919397321,
#     'lambda_l2':        0.0039689175176025465,
#     'learning_rate':    0.03231007103195577,
#     'max_depth':        5,
#     'num_leaves':       103,
#     'colsample_bytree': 0.8329551585827726,
#     'colsample_bynode': 0.4025961355653304,
#     'bagging_fraction': 0.7738954452473223,
#     'bagging_freq':     4,
#     'min_data_in_leaf': 85,
#     'scale_pos_weight': 2.7984184778875543,
# }
#
#
# lgb_model = Pipeline([
#    ('sampler_1', RandomOverSampler(sampling_strategy=0.003, random_state=seed)),
#     ('sampler_2', RandomUnderSampler(sampling_strategy=sampling_ratio , random_state=seed)),
#     ('classifier', lgb.LGBMClassifier(**lgb_params)),
# ])



xgb_feats =  ['clin_size_long_diam_mm', 'tbp_lv_deltaLBnorm', 'lesion_color_difference', 'color_uniformity', 'mean_hue_difference', 'age_normalized_nevi_confidence_2', 'age_approx_patient_norm', 'clin_size_long_diam_mm_patient_norm', 'tbp_lv_B_patient_norm', 'tbp_lv_H_patient_norm', 'tbp_lv_y_patient_norm', 'lesion_color_difference_patient_norm', 'color_uniformity_patient_norm', 'position_distance_3d_patient_norm', 'hue_color_std_interaction_patient_norm', 'mean_hue_difference_patient_norm', 'overall_color_difference_patient_norm', 'age_normalized_nevi_confidence_2_patient_norm', 'color_asymmetry_index_patient_norm', 'count_per_patient', 'age_approx_patient_min_max', 'tbp_lv_B_patient_min_max', 'tbp_lv_H_patient_min_max', 'tbp_lv_Hext_patient_min_max', 'tbp_lv_deltaA_patient_min_max', 'tbp_lv_minorAxisMM_patient_min_max', 'tbp_lv_y_patient_min_max', 'position_distance_3d_patient_min_max', 'area_to_perimeter_ratio_patient_min_max', 'mean_hue_difference_patient_min_max', 'lesion_orientation_3d_patient_min_max', 'overall_color_difference_patient_min_max', 'color_variance_ratio_patient_min_max', 'border_color_interaction_2_patient_min_max', 'pred_40_patient_norm', 'pred_18_patient_min_max_norm', 'pred_27_patient_min_max_norm', 'b_pred_12_patient_norm', 'b_pred_16_patient_norm', 'b_pred_26_patient_norm', 'b_pred_46_patient_norm', 'b_pred_59_patient_norm', 'b_pred_29_patient_min_max_norm', 'b_pred_36_patient_min_max_norm', 'image_pred_1_patient_norm', 'image_pred_15_patient_norm', 'image_pred_41_patient_norm', 'image_pred_2_patient_min_max_norm', 'image_pred_5_patient_min_max_norm', 'image_pred_17_patient_min_max_norm', 'image_pred_18_patient_min_max_norm', 'image_pred_22_patient_min_max_norm', 'image_pred_23_patient_min_max_norm', 'image_pred_46_patient_min_max_norm', 'image_pred_52_patient_min_max_norm', 'image_pred_56_patient_min_max_norm', 'image_pred_59_patient_min_max_norm', 'onehot_45', 'pred_2', 'pred_12', 'pred_27', 'tbp_lv_H_future_norm', 'tbp_lv_L_future_norm', 'lesion_visibility_score_future_norm', 'size_age_interaction_future_norm', 'overall_color_difference_future_norm', 'age_normalized_nevi_confidence_2_future_norm', 'pred_27_future_norm', 'b_pred_26_future_norm', 'image_pred_5_future_norm', 'image_pred_17_future_norm', 'image_pred_19_future_norm', 'image_pred_20_future_norm', 'tbp_lv_Hext_past_norm', 'tbp_lv_nevi_confidence_past_norm', 'hue_contrast_past_norm', 'lesion_orientation_3d_past_norm', 'pred_1_past_norm', 'pred_6_past_norm', 'pred_17_past_norm', 'pred_18_past_norm', 'pred_27_past_norm', 'b_pred_11_past_norm', 'b_pred_34_past_norm', 'b_pred_46_past_norm', 'b_pred_52_past_norm', 'b_pred_56_past_norm', 'b_pred_58_past_norm', 'image_pred_18_past_norm', 'image_pred_39_past_norm', 'count_past', 'clin_size_long_diam_mm_attri_norm', 'tbp_lv_deltaLBnorm_attri_norm', 'hue_contrast_attri_norm', 'color_uniformity_attri_norm', 'normalized_lesion_size_attri_norm', 'count_per_patient_attri_norm', 'pred_19_attri_norm', 'pred_31_attri_norm', 'b_pred_6_attri_norm', 'b_pred_26_attri_norm', 'b_pred_36_attri_norm', 'image_pred_17_attri_norm', 'image_pred_31_attri_norm', 'image_pred_46_attri_norm', 'image_pred_48_attri_norm', 'clin_size_long_diam_mm_tile_type_norm', 'tbp_lv_Lext_tile_type_norm', 'tbp_lv_deltaLBnorm_tile_type_norm', 'tbp_lv_y_tile_type_norm', 'pred_6_tile_type_norm', 'pred_27_tile_type_norm', 'b_pred_2_tile_type_norm', 'b_pred_26_tile_type_norm', 'b_pred_28_tile_type_norm', 'b_pred_47_tile_type_norm', 'image_pred_41_tile_type_norm', 'image_pred_46_tile_type_norm', 'image_pred_48_tile_type_norm', 'image_pred_59_tile_type_norm', 'tbp_lv_B_anatom_norm', 'tbp_lv_Bext_anatom_norm', 'tbp_lv_H_anatom_norm', 'tbp_lv_deltaLBnorm_anatom_norm', 'tbp_lv_radial_color_std_max_anatom_norm', 'tbp_lv_y_anatom_norm', 'hue_contrast_anatom_norm', 'color_uniformity_anatom_norm', 'std_dev_contrast_anatom_norm', 'age_normalized_nevi_confidence_2_anatom_norm', 'pred_39_anatom_norm', 'b_pred_15_anatom_norm', 'b_pred_21_anatom_norm', 'image_pred_41_anatom_norm', 'image_pred_48_anatom_norm', 'tbp_lv_Hext_multi_min_max', 'tbp_lv_radial_color_std_max_multi_min_max', 'tbp_lv_stdLExt_multi_min_max', 'hue_contrast_multi_min_max', 'age_normalized_nevi_confidence_multi_min_max', 'color_asymmetry_index_multi_min_max', 'color_range_multi_min_max', 'index_age_size_symmetry_multi_min_max', 'count_per_patient_multi_min_max', 'pred_18_multi_min_max', 'pred_31_multi_min_max', 'pred_39_multi_min_max', 'b_pred_10_multi_min_max', 'b_pred_12_multi_min_max', 'b_pred_20_multi_min_max', 'b_pred_26_multi_min_max', 'b_pred_36_multi_min_max', 'image_pred_57_multi_min_max']
#153 0.181257


# xgb_params = {
#     'enable_categorical': True,
#     'tree_method':        'hist',
#     'random_state':       seed,
#     'learning_rate':      0.08501257473292347,
#     'lambda':             8.879624125465703,
#     'alpha':              0.6779926606782505,
#     'max_depth':          6,
#     'subsample':          0.6012681388711075,
#     'colsample_bytree':   0.8437772277074493,
#     'colsample_bylevel':  0.5476090898823716,
#     'colsample_bynode':   0.9928601203635129,
#     'scale_pos_weight':   3.29440313334688,
# }
#
# xgb_model = Pipeline([
#    ('sampler_1', RandomOverSampler(sampling_strategy=0.003, random_state=seed)),
#     ('sampler_2', RandomUnderSampler(sampling_strategy=sampling_ratio , random_state=seed)),
#     ('classifier', xgb.XGBClassifier(**xgb_params)),
# ])


cat_feats =  ['clin_size_long_diam_mm', 'tbp_lv_A', 'tbp_lv_H', 'tbp_lv_Hext', 'tbp_lv_deltaLBnorm', 'tbp_lv_x', 'color_uniformity', 'size_age_interaction', 'mean_hue_difference', 'age_normalized_nevi_confidence_2', 'age_size_symmetry_index', 'tbp_lv_A_patient_norm', 'tbp_lv_Aext_patient_norm', 'tbp_lv_B_patient_norm', 'tbp_lv_H_patient_norm', 'hue_contrast_patient_norm', 'color_uniformity_patient_norm', 'position_distance_3d_patient_norm', 'lesion_visibility_score_patient_norm', 'size_age_interaction_patient_norm', 'std_dev_contrast_patient_norm', 'overall_color_difference_patient_norm', 'age_normalized_nevi_confidence_patient_norm', 'age_normalized_nevi_confidence_2_patient_norm', 'color_asymmetry_index_patient_norm', 'tbp_lv_deltaA_patient_min_max', 'tbp_lv_symm_2axis_patient_min_max', 'tbp_lv_y_patient_min_max', 'tbp_lv_z_patient_min_max', 'position_distance_3d_patient_min_max', 'area_to_perimeter_ratio_patient_min_max', 'consistency_symmetry_border_patient_min_max', 'mean_hue_difference_patient_min_max', 'color_variance_ratio_patient_min_max', 'color_asymmetry_index_patient_min_max', 'pred_16_patient_norm', 'pred_31_patient_norm', 'pred_5_patient_min_max_norm', 'pred_22_patient_min_max_norm', 'pred_23_patient_min_max_norm', 'b_pred_2_patient_norm', 'b_pred_6_patient_norm', 'b_pred_12_patient_norm', 'b_pred_13_patient_norm', 'b_pred_16_patient_norm', 'b_pred_17_patient_norm', 'b_pred_18_patient_norm', 'b_pred_26_patient_norm', 'b_pred_45_patient_norm', 'b_pred_46_patient_norm', 'b_pred_54_patient_norm', 'b_pred_59_patient_norm', 'b_pred_51_patient_min_max_norm', 'b_pred_57_patient_min_max_norm', 'image_pred_2_patient_norm', 'image_pred_23_patient_norm', 'image_pred_37_patient_norm', 'image_pred_42_patient_norm', 'image_pred_56_patient_norm', 'image_pred_16_patient_min_max_norm', 'image_pred_23_patient_min_max_norm', 'image_pred_26_patient_min_max_norm', 'image_pred_41_patient_min_max_norm', 'image_pred_59_patient_min_max_norm', 'pred_12', 'pred_39', 'age_approx_future_norm', 'tbp_lv_H_future_norm', 'tbp_lv_deltaB_future_norm', 'tbp_lv_y_future_norm', 'lesion_visibility_score_future_norm', 'color_contrast_index_future_norm', 'color_shape_composite_index_future_norm', 'lesion_orientation_3d_future_norm', 'overall_color_difference_future_norm', 'border_length_ratio_future_norm', 'pred_22_future_norm', 'pred_27_future_norm', 'image_pred_56_future_norm', 'image_pred_59_future_norm', 'color_uniformity_past_norm', 'pred_27_past_norm', 'b_pred_26_past_norm', 'b_pred_51_past_norm', 'image_pred_42_past_norm', 'image_pred_56_past_norm', 'image_pred_59_past_norm', 'count_past', 'age_approx_attri_norm', 'tbp_lv_deltaLBnorm_attri_norm', 'tbp_lv_symm_2axis_angle_attri_norm', 'volume_approximation_3d_attri_norm', 'age_size_symmetry_index_attri_norm', 'index_age_size_symmetry_attri_norm', 'count_per_patient_attri_norm', 'b_pred_12_attri_norm', 'b_pred_26_attri_norm', 'b_pred_57_attri_norm', 'image_pred_15_attri_norm', 'clin_size_long_diam_mm_tile_type_norm', 'tbp_lv_Aext_tile_type_norm', 'tbp_lv_deltaLBnorm_tile_type_norm', 'color_uniformity_tile_type_norm', 'normalized_lesion_size_tile_type_norm', 'pred_9_tile_type_norm', 'b_pred_14_tile_type_norm', 'b_pred_29_tile_type_norm', 'image_pred_18_tile_type_norm', 'image_pred_39_tile_type_norm', 'image_pred_46_tile_type_norm', 'image_pred_52_tile_type_norm', 'tbp_lv_B_anatom_norm', 'hue_contrast_anatom_norm', 'color_consistency_anatom_norm', 'size_age_interaction_anatom_norm', 'overall_color_difference_anatom_norm', 'pred_27_anatom_norm', 'pred_35_anatom_norm', 'b_pred_10_anatom_norm', 'b_pred_38_anatom_norm', 'b_pred_56_anatom_norm', 'image_pred_3_anatom_norm', 'image_pred_8_anatom_norm', 'image_pred_12_anatom_norm', 'image_pred_23_anatom_norm', 'image_pred_26_anatom_norm', 'image_pred_43_anatom_norm', 'tbp_lv_A_multi_min_max', 'tbp_lv_Hext_multi_min_max', 'tbp_lv_radial_color_std_max_multi_min_max', 'tbp_lv_stdLExt_multi_min_max', 'size_age_interaction_multi_min_max', 'symmetry_perimeter_interaction_multi_min_max', 'color_asymmetry_index_multi_min_max', 'count_per_patient_multi_min_max', 'pred_2_multi_min_max', 'pred_4_multi_min_max', 'pred_5_multi_min_max', 'pred_18_multi_min_max', 'pred_20_multi_min_max', 'pred_27_multi_min_max', 'pred_39_multi_min_max', 'pred_40_multi_min_max', 'pred_42_multi_min_max', 'b_pred_4_multi_min_max', 'b_pred_15_multi_min_max', 'b_pred_25_multi_min_max', 'b_pred_29_multi_min_max', 'b_pred_46_multi_min_max', 'b_pred_51_multi_min_max', 'image_pred_3_multi_min_max', 'image_pred_8_multi_min_max', 'image_pred_23_multi_min_max', 'image_pred_33_multi_min_max', 'image_pred_52_multi_min_max']
# 155 0.176157

# cb_params = {
#     'loss_function':     'Logloss',
#     'iterations':        200,
#     'verbose':           False,
#     'random_state':      seed,
#     'max_depth': 7,
#     'learning_rate': 0.06936242010150652,
#     'scale_pos_weight': 2.6149345838209532,
#     'l2_leaf_reg': 6.216113851699493,
#     'subsample': 0.6249261779711819,
#     'min_data_in_leaf': 24,
#     'cat_features':      [x for x in new_cat_cols if x in cat_feats],
# }

# Best mean

# iteration: 240
# best iter: 173 best score: 0.18197391073468067
# best lgb: 190 best score: 0.18300750352672784
# best xgb: 174 best score: 0.18125725752330862
# best cat: 173 best score: 0.17615763262338782
#
# lgb_feats =  ['clin_size_long_diam_mm', 'color_contrast_index', 'age_normalized_nevi_confidence_2', 'age_approx_patient_norm', 'tbp_lv_H_patient_norm', 'tbp_lv_radial_color_std_max_patient_norm', 'tbp_lv_y_patient_norm', 'color_uniformity_patient_norm', 'position_distance_3d_patient_norm', 'overall_color_difference_patient_norm', 'age_normalized_nevi_confidence_2_patient_norm', 'tbp_lv_Hext_patient_min_max', 'tbp_lv_L_patient_min_max', 'tbp_lv_minorAxisMM_patient_min_max', 'lesion_size_ratio_patient_min_max', 'lesion_orientation_3d_patient_min_max', 'age_normalized_nevi_confidence_2_patient_min_max', 'pred_22_patient_min_max_norm', 'b_pred_26_patient_norm', 'b_pred_59_patient_norm', 'b_pred_57_patient_min_max_norm', 'image_pred_16_patient_norm', 'image_pred_45_patient_norm', 'image_pred_56_patient_norm', 'image_pred_57_patient_norm', 'image_pred_16_patient_min_max_norm', 'image_pred_17_patient_min_max_norm', 'image_pred_18_patient_min_max_norm', 'image_pred_21_patient_min_max_norm', 'image_pred_23_patient_min_max_norm', 'image_pred_56_patient_min_max_norm', 'pred_12', 'tbp_lv_H_future_norm', 'lesion_severity_index_future_norm', 'age_normalized_nevi_confidence_2_future_norm', 'lesion_orientation_3d_past_norm', 'b_pred_46_past_norm', 'b_pred_52_past_norm', 'b_pred_58_past_norm', 'image_pred_2_past_norm', 'image_pred_20_past_norm', 'image_pred_39_past_norm', 'count_past', 'hue_contrast_attri_norm', 'border_complexity_attri_norm', 'color_uniformity_attri_norm', 'b_pred_16_attri_norm', 'b_pred_26_attri_norm', 'image_pred_48_attri_norm', 'clin_size_long_diam_mm_tile_type_norm', 'tbp_lv_B_tile_type_norm', 'position_distance_3d_tile_type_norm', 'count_per_patient_tile_type_norm', 'pred_6_tile_type_norm', 'pred_27_tile_type_norm', 'b_pred_47_tile_type_norm', 'b_pred_51_tile_type_norm', 'tbp_lv_deltaLBnorm_anatom_norm', 'tbp_lv_y_anatom_norm', 'color_range_anatom_norm', 'pred_24_anatom_norm', 'pred_39_anatom_norm', 'b_pred_21_anatom_norm', 'image_pred_26_anatom_norm', 'image_pred_49_anatom_norm', 'tbp_lv_Hext_multi_min_max', 'tbp_lv_stdLExt_multi_min_max', 'normalized_lesion_size_multi_min_max', 'count_per_patient_multi_min_max', 'pred_2_multi_min_max', 'pred_9_multi_min_max', 'pred_31_multi_min_max', 'pred_39_multi_min_max', 'b_pred_10_multi_min_max', 'b_pred_20_multi_min_max', 'image_pred_33_multi_min_max']
# cat_feats =  ['clin_size_long_diam_mm', 'tbp_lv_H', 'tbp_lv_deltaLBnorm', 'tbp_lv_x', 'size_age_interaction', 'mean_hue_difference', 'tbp_lv_B_patient_norm', 'tbp_lv_H_patient_norm', 'color_uniformity_patient_norm', 'position_distance_3d_patient_norm', 'lesion_visibility_score_patient_norm', 'overall_color_difference_patient_norm', 'age_normalized_nevi_confidence_2_patient_norm', 'color_asymmetry_index_patient_norm', 'tbp_lv_deltaA_patient_min_max', 'tbp_lv_y_patient_min_max', 'position_distance_3d_patient_min_max', 'area_to_perimeter_ratio_patient_min_max', 'color_asymmetry_index_patient_min_max', 'pred_16_patient_norm', 'pred_22_patient_min_max_norm', 'b_pred_2_patient_norm', 'b_pred_6_patient_norm', 'b_pred_12_patient_norm', 'b_pred_13_patient_norm', 'b_pred_16_patient_norm', 'b_pred_26_patient_norm', 'b_pred_46_patient_norm', 'b_pred_59_patient_norm', 'b_pred_57_patient_min_max_norm', 'image_pred_42_patient_norm', 'image_pred_41_patient_min_max_norm', 'pred_12', 'pred_39', 'age_approx_future_norm', 'tbp_lv_H_future_norm', 'lesion_orientation_3d_future_norm', 'overall_color_difference_future_norm', 'pred_22_future_norm', 'image_pred_56_future_norm', 'image_pred_59_future_norm', 'color_uniformity_past_norm', 'count_past', 'age_approx_attri_norm', 'tbp_lv_deltaLBnorm_attri_norm', 'volume_approximation_3d_attri_norm', 'index_age_size_symmetry_attri_norm', 'count_per_patient_attri_norm', 'b_pred_12_attri_norm', 'b_pred_26_attri_norm', 'b_pred_57_attri_norm', 'clin_size_long_diam_mm_tile_type_norm', 'color_uniformity_tile_type_norm', 'normalized_lesion_size_tile_type_norm', 'b_pred_14_tile_type_norm', 'image_pred_46_tile_type_norm', 'tbp_lv_B_anatom_norm', 'hue_contrast_anatom_norm', 'size_age_interaction_anatom_norm', 'pred_27_anatom_norm', 'image_pred_3_anatom_norm', 'image_pred_12_anatom_norm', 'image_pred_23_anatom_norm', 'image_pred_26_anatom_norm', 'tbp_lv_A_multi_min_max', 'tbp_lv_radial_color_std_max_multi_min_max', 'tbp_lv_stdLExt_multi_min_max', 'count_per_patient_multi_min_max', 'pred_2_multi_min_max', 'pred_4_multi_min_max', 'pred_18_multi_min_max', 'pred_39_multi_min_max', 'b_pred_46_multi_min_max', 'image_pred_23_multi_min_max', 'image_pred_33_multi_min_max', 'image_pred_52_multi_min_max']
# xgb_feats =  ['clin_size_long_diam_mm', 'tbp_lv_deltaLBnorm', 'color_uniformity', 'mean_hue_difference', 'age_normalized_nevi_confidence_2', 'age_approx_patient_norm', 'clin_size_long_diam_mm_patient_norm', 'tbp_lv_H_patient_norm', 'tbp_lv_y_patient_norm', 'lesion_color_difference_patient_norm', 'position_distance_3d_patient_norm', 'mean_hue_difference_patient_norm', 'age_normalized_nevi_confidence_2_patient_norm', 'age_approx_patient_min_max', 'tbp_lv_B_patient_min_max', 'tbp_lv_H_patient_min_max', 'tbp_lv_minorAxisMM_patient_min_max', 'position_distance_3d_patient_min_max', 'area_to_perimeter_ratio_patient_min_max', 'pred_27_patient_min_max_norm', 'b_pred_26_patient_norm', 'b_pred_59_patient_norm', 'image_pred_41_patient_norm', 'image_pred_2_patient_min_max_norm', 'image_pred_5_patient_min_max_norm', 'image_pred_46_patient_min_max_norm', 'onehot_45', 'pred_27', 'tbp_lv_H_future_norm', 'lesion_visibility_score_future_norm', 'overall_color_difference_future_norm', 'age_normalized_nevi_confidence_2_future_norm', 'pred_27_future_norm', 'b_pred_26_future_norm', 'image_pred_19_future_norm', 'tbp_lv_nevi_confidence_past_norm', 'hue_contrast_past_norm', 'lesion_orientation_3d_past_norm', 'pred_27_past_norm', 'b_pred_34_past_norm', 'b_pred_58_past_norm', 'image_pred_39_past_norm', 'count_past', 'clin_size_long_diam_mm_attri_norm', 'hue_contrast_attri_norm', 'color_uniformity_attri_norm', 'normalized_lesion_size_attri_norm', 'pred_31_attri_norm', 'b_pred_26_attri_norm', 'b_pred_36_attri_norm', 'image_pred_46_attri_norm', 'clin_size_long_diam_mm_tile_type_norm', 'tbp_lv_Lext_tile_type_norm', 'tbp_lv_deltaLBnorm_tile_type_norm', 'pred_6_tile_type_norm', 'pred_27_tile_type_norm', 'b_pred_26_tile_type_norm', 'b_pred_28_tile_type_norm', 'image_pred_41_tile_type_norm', 'image_pred_48_tile_type_norm', 'image_pred_59_tile_type_norm', 'tbp_lv_H_anatom_norm', 'tbp_lv_deltaLBnorm_anatom_norm', 'tbp_lv_radial_color_std_max_anatom_norm', 'hue_contrast_anatom_norm', 'color_uniformity_anatom_norm', 'std_dev_contrast_anatom_norm', 'image_pred_48_anatom_norm', 'tbp_lv_radial_color_std_max_multi_min_max', 'color_asymmetry_index_multi_min_max', 'count_per_patient_multi_min_max', 'pred_31_multi_min_max', 'pred_39_multi_min_max', 'b_pred_12_multi_min_max', 'b_pred_20_multi_min_max', 'b_pred_36_multi_min_max']
# lgb feats: 76 cat feats: 76 xgb feats: 76
#
# Fold 1 - Validation Score: 0.18683334937594248 lgb: 0.18652773767125483 xgb: 0.1834238136490519 cat: 0.17971829178297558
# Fold 2 - Validation Score: 0.17771704748141762 lgb: 0.177856613143134 xgb: 0.17164799091037958 cat: 0.16945511470990862
# Fold 3 - Validation Score: 0.18125586890835305 lgb: 0.1836290852183024 xgb: 0.17786507352833053 cat: 0.17326277485040856
# Fold 4 - Validation Score: 0.18316035057021376 lgb: 0.18532973400254787 xgb: 0.1766436816012033 cat: 0.1702143098340777
# Fold 5 - Validation Score: 0.18122255605468363 lgb: 0.18055053186317402 xgb: 0.16605375999066563 cat: 0.1821820975050074
# Average Validation Score: 0.1820378344781221 average lgb: 0.1827787403796826 average xgb: 0.1751268639359262 average cat: 0.17496651773647556


lgb_feats =  ['clin_size_long_diam_mm', 'tbp_lv_Aext', 'tbp_lv_B', 'tbp_lv_C', 'tbp_lv_H', 'tbp_lv_Lext', 'tbp_lv_deltaLBnorm', 'tbp_lv_minorAxisMM', 'color_uniformity', 'position_distance_3d', 'color_contrast_index', 'mean_hue_difference', 'age_normalized_nevi_confidence', 'age_normalized_nevi_confidence_2', 'age_approx_patient_norm', 'tbp_lv_Aext_patient_norm', 'tbp_lv_B_patient_norm', 'tbp_lv_H_patient_norm', 'tbp_lv_L_patient_norm', 'tbp_lv_area_perim_ratio_patient_norm', 'tbp_lv_deltaB_patient_norm', 'tbp_lv_minorAxisMM_patient_norm', 'tbp_lv_radial_color_std_max_patient_norm', 'tbp_lv_y_patient_norm', 'color_uniformity_patient_norm', 'position_distance_3d_patient_norm', 'lesion_visibility_score_patient_norm', 'size_age_interaction_patient_norm', 'lesion_orientation_3d_patient_norm', 'overall_color_difference_patient_norm', 'age_normalized_nevi_confidence_2_patient_norm', 'color_asymmetry_index_patient_norm', 'color_range_patient_norm', 'count_per_patient', 'age_approx_patient_min_max', 'tbp_lv_B_patient_min_max', 'tbp_lv_H_patient_min_max', 'tbp_lv_Hext_patient_min_max', 'tbp_lv_L_patient_min_max', 'tbp_lv_deltaA_patient_min_max', 'tbp_lv_minorAxisMM_patient_min_max', 'tbp_lv_radial_color_std_max_patient_min_max', 'tbp_lv_y_patient_min_max', 'tbp_lv_z_patient_min_max', 'position_distance_3d_patient_min_max', 'perimeter_to_area_ratio_patient_min_max', 'area_to_perimeter_ratio_patient_min_max', 'lesion_orientation_3d_patient_min_max', 'color_variance_ratio_patient_min_max', 'age_normalized_nevi_confidence_2_patient_min_max', 'border_length_ratio_patient_min_max', 'age_size_symmetry_index_patient_min_max', 'index_age_size_symmetry_patient_min_max', 'b_pred_11_patient_norm', 'b_pred_16_patient_norm', 'b_pred_19_patient_norm', 'b_pred_26_patient_norm', 'b_pred_38_patient_norm', 'b_pred_52_patient_norm', 'b_pred_59_patient_norm', 'b_pred_3_patient_min_max_norm', 'b_pred_5_patient_min_max_norm', 'b_pred_12_patient_min_max_norm', 'b_pred_16_patient_min_max_norm', 'b_pred_29_patient_min_max_norm', 'b_pred_40_patient_min_max_norm', 'b_pred_42_patient_min_max_norm', 'b_pred_46_patient_min_max_norm', 'b_pred_57_patient_min_max_norm', 'onehot_45', 'b_pred_1', 'b_pred_12', 'b_pred_28', 'b_pred_36', 'b_pred_47', 'b_pred_55', 'age_approx_future_norm', 'tbp_lv_H_future_norm', 'tbp_lv_Hext_future_norm', 'tbp_lv_L_future_norm', 'position_distance_3d_future_norm', 'lesion_visibility_score_future_norm', 'lesion_severity_index_future_norm', 'overall_color_difference_future_norm', 'age_normalized_nevi_confidence_2_future_norm', 'b_pred_51_future_norm', 'age_approx_past_norm', 'tbp_lv_nevi_confidence_past_norm', 'lesion_size_ratio_past_norm', 'hue_contrast_past_norm', 'color_uniformity_past_norm', 'lesion_severity_index_past_norm', 'lesion_orientation_3d_past_norm', 'b_pred_1_past_norm', 'b_pred_3_past_norm', 'b_pred_6_past_norm', 'b_pred_9_past_norm', 'b_pred_11_past_norm', 'b_pred_17_past_norm', 'b_pred_44_past_norm', 'b_pred_46_past_norm', 'b_pred_49_past_norm', 'b_pred_52_past_norm', 'b_pred_53_past_norm', 'b_pred_58_past_norm', 'count_future', 'count_past', 'clin_size_long_diam_mm_attri_norm', 'tbp_lv_C_attri_norm', 'tbp_lv_deltaA_attri_norm', 'tbp_lv_deltaB_attri_norm', 'tbp_lv_eccentricity_attri_norm', 'tbp_lv_symm_2axis_angle_attri_norm', 'hue_contrast_attri_norm', 'border_complexity_attri_norm', 'color_uniformity_attri_norm', 'overall_color_difference_attri_norm', 'index_age_size_symmetry_attri_norm', 'count_per_patient_attri_norm', 'b_pred_6_attri_norm', 'b_pred_15_attri_norm', 'b_pred_16_attri_norm', 'b_pred_26_attri_norm', 'b_pred_27_attri_norm', 'clin_size_long_diam_mm_tile_type_norm', 'tbp_lv_Aext_tile_type_norm', 'tbp_lv_Bext_tile_type_norm', 'tbp_lv_C_tile_type_norm', 'tbp_lv_L_tile_type_norm', 'tbp_lv_Lext_tile_type_norm', 'tbp_lv_deltaLBnorm_tile_type_norm', 'position_distance_3d_tile_type_norm', 'age_normalized_nevi_confidence_2_tile_type_norm', 'count_per_patient_tile_type_norm', 'b_pred_2_tile_type_norm', 'b_pred_14_tile_type_norm', 'b_pred_16_tile_type_norm', 'b_pred_26_tile_type_norm', 'b_pred_27_tile_type_norm', 'b_pred_46_tile_type_norm', 'b_pred_47_tile_type_norm', 'age_approx_anatom_norm', 'clin_size_long_diam_mm_anatom_norm', 'tbp_lv_radial_color_std_max_anatom_norm', 'tbp_lv_y_anatom_norm', 'hue_contrast_anatom_norm', 'lesion_color_difference_anatom_norm', 'color_uniformity_anatom_norm', 'lesion_severity_index_anatom_norm', 'b_pred_7_anatom_norm', 'b_pred_12_anatom_norm', 'b_pred_15_anatom_norm', 'b_pred_21_anatom_norm', 'b_pred_33_anatom_norm', 'b_pred_57_anatom_norm', 'tbp_lv_B_multi_min_max', 'tbp_lv_H_multi_min_max', 'tbp_lv_Hext_multi_min_max', 'tbp_lv_Lext_multi_min_max', 'tbp_lv_deltaA_multi_min_max', 'tbp_lv_stdLExt_multi_min_max', 'hue_contrast_multi_min_max', 'consistency_symmetry_border_multi_min_max', 'size_age_interaction_multi_min_max', 'normalized_lesion_size_multi_min_max', 'std_dev_contrast_multi_min_max', 'lesion_orientation_3d_multi_min_max', 'color_variance_ratio_multi_min_max', 'age_normalized_nevi_confidence_multi_min_max', 'age_normalized_nevi_confidence_2_multi_min_max', 'index_age_size_symmetry_multi_min_max', 'count_per_patient_multi_min_max', 'b_pred_6_multi_min_max', 'b_pred_10_multi_min_max', 'b_pred_14_multi_min_max', 'b_pred_20_multi_min_max', 'b_pred_24_multi_min_max', 'b_pred_25_multi_min_max', 'b_pred_28_multi_min_max', 'b_pred_29_multi_min_max', 'b_pred_37_multi_min_max', 'b_pred_47_multi_min_max', 'b_pred_48_multi_min_max', 'b_pred_54_multi_min_max', 'b_pred_56_multi_min_max']
cat_feats =  ['clin_size_long_diam_mm', 'tbp_lv_C', 'tbp_lv_H', 'tbp_lv_areaMM2', 'tbp_lv_area_perim_ratio', 'tbp_lv_deltaA', 'tbp_lv_deltaLBnorm', 'tbp_lv_stdLExt', 'tbp_lv_y', 'tbp_lv_z', 'color_uniformity', 'size_age_interaction', 'normalized_lesion_size', 'mean_hue_difference', 'clin_size_long_diam_mm_patient_norm', 'tbp_lv_A_patient_norm', 'tbp_lv_Aext_patient_norm', 'tbp_lv_B_patient_norm', 'tbp_lv_C_patient_norm', 'tbp_lv_H_patient_norm', 'tbp_lv_Hext_patient_norm', 'tbp_lv_color_std_mean_patient_norm', 'tbp_lv_nevi_confidence_patient_norm', 'tbp_lv_stdL_patient_norm', 'tbp_lv_y_patient_norm', 'color_uniformity_patient_norm', 'position_distance_3d_patient_norm', 'lesion_visibility_score_patient_norm', 'mean_hue_difference_patient_norm', 'overall_color_difference_patient_norm', 'age_normalized_nevi_confidence_2_patient_norm', 'color_asymmetry_index_patient_norm', 'tbp_lv_B_patient_min_max', 'tbp_lv_H_patient_min_max', 'tbp_lv_L_patient_min_max', 'tbp_lv_minorAxisMM_patient_min_max', 'tbp_lv_radial_color_std_max_patient_min_max', 'tbp_lv_symm_2axis_patient_min_max', 'tbp_lv_x_patient_min_max', 'tbp_lv_y_patient_min_max', 'tbp_lv_z_patient_min_max', 'position_distance_3d_patient_min_max', 'perimeter_to_area_ratio_patient_min_max', 'consistency_symmetry_border_patient_min_max', 'size_age_interaction_patient_min_max', 'lesion_orientation_3d_patient_min_max', 'color_variance_ratio_patient_min_max', 'age_normalized_nevi_confidence_2_patient_min_max', 'color_asymmetry_index_patient_min_max', 'index_age_size_symmetry_patient_min_max', 'b_pred_1_patient_norm', 'b_pred_2_patient_norm', 'b_pred_5_patient_norm', 'b_pred_6_patient_norm', 'b_pred_12_patient_norm', 'b_pred_13_patient_norm', 'b_pred_15_patient_norm', 'b_pred_16_patient_norm', 'b_pred_18_patient_norm', 'b_pred_23_patient_norm', 'b_pred_26_patient_norm', 'b_pred_46_patient_norm', 'b_pred_57_patient_norm', 'b_pred_59_patient_norm', 'b_pred_12_patient_min_max_norm', 'b_pred_16_patient_min_max_norm', 'b_pred_28_patient_min_max_norm', 'b_pred_29_patient_min_max_norm', 'b_pred_36_patient_min_max_norm', 'b_pred_40_patient_min_max_norm', 'b_pred_42_patient_min_max_norm', 'b_pred_46_patient_min_max_norm', 'b_pred_47_patient_min_max_norm', 'b_pred_53_patient_min_max_norm', 'b_pred_57_patient_min_max_norm', 'onehot_11', 'onehot_15', 'onehot_32', 'onehot_46', 'b_pred_7', 'b_pred_10', 'b_pred_12', 'b_pred_15', 'b_pred_17', 'b_pred_26', 'b_pred_33', 'b_pred_38', 'b_pred_46', 'b_pred_57', 'age_approx_future_norm', 'tbp_lv_A_future_norm', 'tbp_lv_Aext_future_norm', 'tbp_lv_y_future_norm', 'lesion_visibility_score_future_norm', 'lesion_orientation_3d_future_norm', 'b_pred_12_future_norm', 'b_pred_26_future_norm', 'b_pred_40_future_norm', 'b_pred_59_future_norm', 'tbp_lv_C_past_norm', 'hue_contrast_past_norm', 'color_uniformity_past_norm', 'color_shape_composite_index_past_norm', 'lesion_orientation_3d_past_norm', 'overall_color_difference_past_norm', 'border_color_interaction_past_norm', 'border_length_ratio_past_norm', 'b_pred_3_past_norm', 'b_pred_12_past_norm', 'b_pred_13_past_norm', 'b_pred_26_past_norm', 'b_pred_40_past_norm', 'b_pred_58_past_norm', 'count_past', 'age_approx_attri_norm', 'tbp_lv_deltaA_attri_norm', 'tbp_lv_deltaLBnorm_attri_norm', 'tbp_lv_symm_2axis_angle_attri_norm', 'hue_contrast_attri_norm', 'color_uniformity_attri_norm', 'perimeter_to_area_ratio_attri_norm', 'size_age_interaction_attri_norm', 'volume_approximation_3d_attri_norm', 'count_per_patient_attri_norm', 'b_pred_17_attri_norm', 'b_pred_52_attri_norm', 'clin_size_long_diam_mm_tile_type_norm', 'tbp_lv_Aext_tile_type_norm', 'tbp_lv_Hext_tile_type_norm', 'tbp_lv_deltaLBnorm_tile_type_norm', 'tbp_lv_y_tile_type_norm', 'normalized_lesion_size_tile_type_norm', 'age_normalized_nevi_confidence_2_tile_type_norm', 'index_age_size_symmetry_tile_type_norm', 'b_pred_2_tile_type_norm', 'b_pred_14_tile_type_norm', 'b_pred_26_tile_type_norm', 'b_pred_27_tile_type_norm', 'b_pred_46_tile_type_norm', 'age_approx_anatom_norm', 'tbp_lv_H_anatom_norm', 'tbp_lv_Lext_anatom_norm', 'color_consistency_anatom_norm', 'b_pred_22_anatom_norm', 'b_pred_28_anatom_norm', 'b_pred_43_anatom_norm', 'b_pred_48_anatom_norm', 'b_pred_52_anatom_norm', 'b_pred_57_anatom_norm', 'tbp_lv_A_multi_min_max', 'tbp_lv_H_multi_min_max', 'tbp_lv_perimeterMM_multi_min_max', 'tbp_lv_radial_color_std_max_multi_min_max', 'tbp_lv_stdL_multi_min_max', 'tbp_lv_stdLExt_multi_min_max', 'tbp_lv_y_multi_min_max', 'color_uniformity_multi_min_max', 'area_to_perimeter_ratio_multi_min_max', 'size_age_interaction_multi_min_max', 'hue_color_std_interaction_multi_min_max', 'log_lesion_area_multi_min_max', 'std_dev_contrast_multi_min_max', 'color_shape_composite_index_multi_min_max', 'symmetry_perimeter_interaction_multi_min_max', 'border_color_interaction_multi_min_max', 'age_normalized_nevi_confidence_multi_min_max', 'color_asymmetry_index_multi_min_max', 'age_size_symmetry_index_multi_min_max', 'index_age_size_symmetry_multi_min_max', 'count_per_patient_multi_min_max', 'b_pred_4_multi_min_max', 'b_pred_6_multi_min_max', 'b_pred_15_multi_min_max', 'b_pred_17_multi_min_max', 'b_pred_18_multi_min_max', 'b_pred_19_multi_min_max', 'b_pred_20_multi_min_max', 'b_pred_25_multi_min_max', 'b_pred_27_multi_min_max', 'b_pred_29_multi_min_max', 'b_pred_37_multi_min_max', 'b_pred_42_multi_min_max', 'b_pred_45_multi_min_max', 'b_pred_47_multi_min_max', 'b_pred_51_multi_min_max']
xgb_feats =  ['clin_size_long_diam_mm', 'tbp_lv_B', 'tbp_lv_C', 'tbp_lv_H', 'tbp_lv_Lext', 'tbp_lv_deltaA', 'tbp_lv_deltaLBnorm', 'color_uniformity', 'color_contrast_index', 'mean_hue_difference', 'overall_color_difference', 'age_normalized_nevi_confidence', 'age_normalized_nevi_confidence_2', 'color_asymmetry_index', 'volume_approximation_3d', 'clin_size_long_diam_mm_patient_norm', 'tbp_lv_B_patient_norm', 'tbp_lv_H_patient_norm', 'tbp_lv_L_patient_norm', 'tbp_lv_radial_color_std_max_patient_norm', 'tbp_lv_y_patient_norm', 'lesion_color_difference_patient_norm', 'color_uniformity_patient_norm', 'position_distance_3d_patient_norm', 'lesion_visibility_score_patient_norm', 'size_age_interaction_patient_norm', 'hue_color_std_interaction_patient_norm', 'mean_hue_difference_patient_norm', 'color_shape_composite_index_patient_norm', 'overall_color_difference_patient_norm', 'age_normalized_nevi_confidence_2_patient_norm', 'color_asymmetry_index_patient_norm', 'age_approx_patient_min_max', 'tbp_lv_B_patient_min_max', 'tbp_lv_H_patient_min_max', 'tbp_lv_Hext_patient_min_max', 'tbp_lv_areaMM2_patient_min_max', 'tbp_lv_deltaA_patient_min_max', 'tbp_lv_deltaB_patient_min_max', 'tbp_lv_norm_color_patient_min_max', 'tbp_lv_perimeterMM_patient_min_max', 'tbp_lv_radial_color_std_max_patient_min_max', 'tbp_lv_y_patient_min_max', 'hue_contrast_patient_min_max', 'position_distance_3d_patient_min_max', 'perimeter_to_area_ratio_patient_min_max', 'area_to_perimeter_ratio_patient_min_max', 'mean_hue_difference_patient_min_max', 'lesion_orientation_3d_patient_min_max', 'overall_color_difference_patient_min_max', 'color_variance_ratio_patient_min_max', 'age_normalized_nevi_confidence_2_patient_min_max', 'color_asymmetry_index_patient_min_max', 'index_age_size_symmetry_patient_min_max', 'b_pred_12_patient_norm', 'b_pred_16_patient_norm', 'b_pred_26_patient_norm', 'b_pred_52_patient_norm', 'b_pred_58_patient_norm', 'b_pred_59_patient_norm', 'b_pred_3_patient_min_max_norm', 'b_pred_12_patient_min_max_norm', 'b_pred_29_patient_min_max_norm', 'b_pred_53_patient_min_max_norm', 'b_pred_57_patient_min_max_norm', 'b_pred_59_patient_min_max_norm', 'onehot_45', 'b_pred_1', 'b_pred_2', 'b_pred_12', 'b_pred_28', 'b_pred_36', 'b_pred_46', 'b_pred_47', 'age_approx_future_norm', 'tbp_lv_H_future_norm', 'tbp_lv_Hext_future_norm', 'tbp_lv_L_future_norm', 'tbp_lv_radial_color_std_max_future_norm', 'tbp_lv_y_future_norm', 'position_distance_3d_future_norm', 'lesion_visibility_score_future_norm', 'overall_color_difference_future_norm', 'age_normalized_nevi_confidence_2_future_norm', 'b_pred_16_future_norm', 'b_pred_18_future_norm', 'b_pred_26_future_norm', 'b_pred_28_future_norm', 'tbp_lv_H_past_norm', 'tbp_lv_nevi_confidence_past_norm', 'hue_contrast_past_norm', 'position_distance_3d_past_norm', 'mean_hue_difference_past_norm', 'lesion_orientation_3d_past_norm', 'overall_color_difference_past_norm', 'color_range_past_norm', 'b_pred_6_past_norm', 'b_pred_9_past_norm', 'b_pred_11_past_norm', 'b_pred_23_past_norm', 'b_pred_26_past_norm', 'b_pred_34_past_norm', 'b_pred_42_past_norm', 'b_pred_44_past_norm', 'b_pred_46_past_norm', 'b_pred_49_past_norm', 'b_pred_52_past_norm', 'b_pred_56_past_norm', 'b_pred_58_past_norm', 'count_past', 'age_approx_attri_norm', 'clin_size_long_diam_mm_attri_norm', 'tbp_lv_Lext_attri_norm', 'tbp_lv_deltaB_attri_norm', 'tbp_lv_deltaLBnorm_attri_norm', 'hue_contrast_attri_norm', 'color_uniformity_attri_norm', 'perimeter_to_area_ratio_attri_norm', 'normalized_lesion_size_attri_norm', 'overall_color_difference_attri_norm', 'count_per_patient_attri_norm', 'b_pred_6_attri_norm', 'b_pred_12_attri_norm', 'b_pred_15_attri_norm', 'b_pred_20_attri_norm', 'b_pred_26_attri_norm', 'b_pred_36_attri_norm', 'b_pred_40_attri_norm', 'clin_size_long_diam_mm_tile_type_norm', 'tbp_lv_Aext_tile_type_norm', 'tbp_lv_deltaLBnorm_tile_type_norm', 'tbp_lv_minorAxisMM_tile_type_norm', 'tbp_lv_y_tile_type_norm', 'hue_contrast_tile_type_norm', 'position_distance_3d_tile_type_norm', 'normalized_lesion_size_tile_type_norm', 'age_normalized_nevi_confidence_2_tile_type_norm', 'count_per_patient_tile_type_norm', 'b_pred_2_tile_type_norm', 'b_pred_14_tile_type_norm', 'b_pred_16_tile_type_norm', 'b_pred_21_tile_type_norm', 'b_pred_26_tile_type_norm', 'b_pred_27_tile_type_norm', 'b_pred_47_tile_type_norm', 'tbp_lv_B_anatom_norm', 'tbp_lv_Bext_anatom_norm', 'tbp_lv_H_anatom_norm', 'tbp_lv_deltaLBnorm_anatom_norm', 'tbp_lv_radial_color_std_max_anatom_norm', 'tbp_lv_y_anatom_norm', 'color_uniformity_anatom_norm', 'std_dev_contrast_anatom_norm', 'age_normalized_nevi_confidence_2_anatom_norm', 'b_pred_6_anatom_norm', 'b_pred_12_anatom_norm', 'b_pred_15_anatom_norm', 'b_pred_28_anatom_norm', 'b_pred_33_anatom_norm', 'b_pred_57_anatom_norm', 'tbp_lv_B_multi_min_max', 'tbp_lv_Hext_multi_min_max', 'tbp_lv_Lext_multi_min_max', 'tbp_lv_radial_color_std_max_multi_min_max', 'tbp_lv_stdLExt_multi_min_max', 'tbp_lv_y_multi_min_max', 'hue_contrast_multi_min_max', 'luminance_contrast_multi_min_max', 'lesion_color_difference_multi_min_max', 'hue_color_std_interaction_multi_min_max', 'normalized_lesion_size_multi_min_max', 'lesion_orientation_3d_multi_min_max', 'age_normalized_nevi_confidence_multi_min_max', 'age_normalized_nevi_confidence_2_multi_min_max', 'color_asymmetry_index_multi_min_max', 'index_age_size_symmetry_multi_min_max', 'count_per_patient_multi_min_max', 'b_pred_1_multi_min_max', 'b_pred_10_multi_min_max', 'b_pred_20_multi_min_max', 'b_pred_25_multi_min_max', 'b_pred_28_multi_min_max', 'b_pred_36_multi_min_max', 'b_pred_37_multi_min_max', 'b_pred_55_multi_min_max']
